<!DOCTYPE html>
<html lang="tr">
<head>
  <meta charset="UTF-8">
  <title>Go WebSocket Chat</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>
  <h2>Go WebSocket Chat</h2>

  <input id="username" placeholder="KullanÄ±cÄ± adÄ±nÄ±z" /><br><br>

  <input id="message" placeholder="MesajÄ±nÄ±z (Ã¶rn: :smile:)" />
  <button onclick="sendMessage()">GÃ¶nder</button>

  <div class="chat-area">
    <ul id="chat"></ul>
  </div>

  <script>
    let socket;

    function sendMessage() {
      const username = document.getElementById("username").value.trim();
      const msg = document.getElementById("message").value.trim();

      if (!username) {
        alert("LÃ¼tfen kullanÄ±cÄ± adÄ±nÄ±zÄ± girin.");
        return;
      }

      if (!socket || socket.readyState !== WebSocket.OPEN) {
        socket = new WebSocket("ws://localhost:8080/ws");

        socket.onopen = function () {
          socket.send(username);
          if (msg) {
            socket.send(msg);
            document.getElementById("message").value = "";
          }
        };

        socket.onmessage = function (event) {
          const li = document.createElement("li");
          const msg = event.data;

          if (msg.includes("katÄ±ldÄ±")) {
            li.style.color = "blue";
            li.style.fontWeight = "bold";
          } else if (msg.includes("ayrÄ±ldÄ±")) {
            li.style.color = "red";
            li.style.fontWeight = "bold";
          } else if (msg.startsWith("ðŸ‘¥")) {
            li.style.color = "green";
            li.style.fontStyle = "italic";
          }

          li.textContent = msg;
          document.getElementById("chat").appendChild(li);
        };

        socket.onerror = function (error) {
          alert("BaÄŸlantÄ± hatasÄ±: " + error.message);
        };

        socket.onclose = function () {
          console.log("BaÄŸlantÄ± kapatÄ±ldÄ±.");
        };
      } else {
        if (msg) {
          socket.send(msg);
          document.getElementById("message").value = "";
        }
      }
    }

    document.getElementById("message").addEventListener("keydown", function (e) {
      if (e.key === "Enter") sendMessage();
    });
  </script>
</body>
</html>